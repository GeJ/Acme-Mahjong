Port this algorithm

http://hp.vector.co.jp/authors/VA046927/mjscore/mjalgorism.html